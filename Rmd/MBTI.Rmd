---
title: "MBTI dataset transformation and analysis"
author: "Vedran Moškov, Lucija Runjić, Borna Josipović, Lana Bartolović"
date: "`r Sys.Date()`"
output:
  pdf_document: default
  html_document:
    df_print: paged
  word_document: default
---

```{r setup, include=FALSE, warning=F}
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(ggplot2)
library(magrittr)
library(gridExtra)
library(nortest)
library(leaps)
```

```{r, echo=F}
rm(list = ls()) # uklanjanje svih varijabli iz okoline
```

```{r, echo=F}
source("../Rscripts/utils.R")
```

***

# Motivacija i opis problema

Istražujemo povezanost između osobnosti, dobivene kroz MBTI test, i fizičkih karakteristika poput držanja tijela, težine i visine. Kroz proučavanje pitanja kao što su "Kako tipovi ličnosti utječu na način držanja?" i "Postoje li razlike u tjelesnoj težini ili visini između različitih tipova ličnosti?" analizom ovih podataka, nastojimo bolje razumjeti veze između mentalnog i fizičkog aspekta individualnosti.

***

# Učitavanje i uređivanje podatkovnog skupa

## Učitavanje i proučavanje podatkovnog skupa 

Učitavamo podatkovni skup u varijablu "dataset".
```{r, message=F}
dataset <- read_csv("../data/MBTI.csv")
```

Proučavamo podatkovni skup kako bi ga znali urediti na način da nam je lakše raditi s njim kasnije.
```{r}
head(dataset)
tail(dataset)
glimpse(dataset)
```

## Uređivanje podataka podatkovnog skupa

Faktoriziramo i modificiramo stupce "SEX", "ACTIVITY LEVEL", "MBTI", "POSTURE"  kako bismo kasnije mogli lakše grupirati podatke i bolje ih analizirati.
```{r}
dataset$SEX <- as.factor(dataset$SEX)
dataset$`ACTIVITY LEVEL` <- as.factor(dataset$`ACTIVITY LEVEL`)
dataset$`ACTIVITY LEVEL` <- factor(
  dataset$`ACTIVITY LEVEL`, levels = c("Low", "Moderate", "High")
  )
dataset$MBTI <- as.factor(dataset$MBTI)
dataset$POSTURE <- as.factor(dataset$POSTURE)
dataset$POSTURE <- factor(dataset$POSTURE, levels = c("A", "B", "C", "D"), 
                          labels = c("idealno", "kifoza/lordoza", "ravna leđa", "nagnuto"))
```

Uklonit ćemo prva dva stupca podatkovnog skupa obzirom da su jedinstveni identifikatori te nam ne pomažu u analizi.
```{r}
dataset$...1 <- NULL
dataset$`S No` <- NULL
```

Preimenovat ćemo stupce "ACTIVITY LEVEL", "PAIN 1", "PAIN 2", "PAIN 3" i "PAIN 4" radi jednostavnosti.
```{r}
colnames(dataset)[5] <- "ACTIVITY_LEVEL"
colnames(dataset)[6] <- "PAIN_1"
colnames(dataset)[7] <- "PAIN_2"
colnames(dataset)[8] <- "PAIN_3"
colnames(dataset)[9] <- "PAIN_4"
```

Pretvorit ćemo podatke u stupcima "HEIGHT" i "WEIGHT" u centimentri i kilograme.
```{r}
dataset$HEIGHT <- round(dataset$HEIGHT * 2.54, 1)
dataset$WEIGHT <- round(dataset$WEIGHT * 0.45359237, 1)
```


Dodat ćemo neke nove stupce pomoću kojih ćemo grupirati podatke u manje grupe kako bismo ih mogli bolje analizirati.
```{r}
dataset$GROUP <- as.factor(color(dataset$MBTI)) 
dataset$IS_ACTIVE <- as.factor(
  ifelse(dataset$ACTIVITY_LEVEL == "Low", "Inactive", "Active")
  )
dataset$IE <- as.factor(substring(dataset$MBTI, 1, 1))
dataset$SN <- as.factor(substr(dataset$MBTI, 2, 2))
dataset$TF <- as.factor(substr(dataset$MBTI, 3, 3))
dataset$JP <- as.factor(substr(dataset$MBTI, 4, 4))
```


Ovako naš podatkovni skup izgleda nakon uređivanja njegovih podataka.
```{r}
head(dataset)
tail(dataset)
glimpse(dataset)
```


***
# Analiza podatkovnog skupa

## Veza između tipa ličnosti i načina držanja

U našem podatkovnom skupu imamo stupce "POSTURE" i "MBTI".

Stupac "POSTURE" poprima vrijednosti:

```{r}
ggplot(dataset, aes(x = POSTURE, fill = POSTURE)) +
  geom_bar() +
  scale_fill_ordinal() + 
  labs(x = "Posture", fill = "Posture", y = "Count")
```

Imamo 4 klase načina držanja: idealno, kifoza/lordoza, ravna leđa, nagnuto.
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
Stupac "MBTI" poprima vrijednosti:
```{r}
ggplot(dataset, aes(x = MBTI, fill = MBTI)) + 
  geom_bar() + 
  scale_fill_ordinal() + 
  theme(axis.text.x = element_text(angle = 45)) + 
  labs(y = "Count")
```                                                                                      
[Razlikujemo 16 vrsta tipova osobnosti](https://www.16personalities.com/personality-types).
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
```{r}
ggplot(dataset, aes(x = GROUP, fill = GROUP)) + 
  geom_bar() + 
  scale_fill_ordinal() + 
  labs(x = "Group", fill = "Group", y = "Count")
```
Tih 16 tipova osobnosti možemo podijeliti u 4 manje grupe kao što je prikazano na grafu iznad.


Provest ćemo hi kvadrat test za kategorijske podatke gdje ćemo proučavati stupce "POSTURE" i "IE" (introvert/ekstrovert) podatkovnog okvira. Pomoću funkcije "check_expected" provjeravamo imamo li uvjete za provedbu testa na temelju dobivenih vrijednosti u našoj kontingencijskoj tablici (vraća TRUE ako su uvjeti za provedbu testa zadovoljeni).
```{r}
contingency_table <- table(dataset$POSTURE, dataset$IE)
contingency_table
check_expected(contingency_table)
```
```{r}
chisq <- chisq.test(contingency_table)
chisq
```
Na temelju rezultata testa zaključujemo da ekstrovertnost ima veze s načinom držanja.

Isti postupak ćemo ponoviti i za raspoznavanje/intuiciju, razmišljanje/osjećanje te produđivanje/opažanje.


```{r}
contingency_table <- table(dataset$POSTURE, dataset$SN)
contingency_table
check_expected(contingency_table)
```
```{r}
chisq <- chisq.test(contingency_table)
chisq
```
Na temelju rezultata testa zaključujemo da raspoznavanje/intuicija nemaju veze s načinom držanja.

```{r}
contingency_table <- table(dataset$POSTURE, dataset$TF)
contingency_table
check_expected(contingency_table)
```
```{r}
chisq <- chisq.test(contingency_table)
chisq
```
Na temelju rezultata testa zaključujemo da razmišljanje/osjećanje nemaju veze sa načinom držanja.

```{r}
contingency_table <- table(dataset$POSTURE, dataset$JP)
contingency_table
check_expected(contingency_table)
```

```{r}
chisq <- chisq.test(contingency_table)
chisq
```
Na temelju rezultata testa zaključujemo da prosuđivanje/opažanje ima veze sa načinom držanja.
\
\
\
\
\
\
\
\
\
\
\



## Veza između fizičke aktivnosti i razine ekstrovertiranosti

Fizičku aktivnost nam predstavlja stupac "ACTIVITY_LEVEL":
```{r}
ggplot(dataset, aes(x = IS_ACTIVE, fill = IS_ACTIVE)) + 
  geom_bar() + 
  scale_fill_ordinal() + 
  labs(x = "Activity level", fill = "Activity level", y = "Count")
```
Prema ovom grafu ljude dijelimo u fizički aktivne i one neaktivne.
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
\
Za koeficijent ekstrovertnosti imamo stupac sa nazivom "E":
```{r}
ggplot(dataset, aes(x = E, fill = E > I)) + geom_bar() + 
  scale_fill_ordinal() + 
  labs(x = "Extroversion", fill = "Extrovert", y = "Count")
```
Na grafu vidimo raspodjelu ljudi koji imaju veći koeficijent ekstrovertnosti od koeficijenta introvertnosti.

Provest ćemo hi kvadrat test za kategorijske podatke gdje ćemo proučavati stupce "IS_ACTIVE" (stupac koji mjeri razinu aktivnosti osobe) i "IE" (introvert/ekstrovert) podatkovnog okvira.
```{r}
contingency_table <- table(dataset$IS_ACTIVE, dataset$IE)
contingency_table
check_expected(contingency_table)
```
```{r, warning=F}
chisq <- chisq.test(contingency_table)
chisq
```
Na temelju rezultata testa zaključujemo da ne postoji veza između fizičke aktivnosti i ekstroverstnosti.




## Razlika u visini/težini obzirom na tip ličnosti

U našem podatkovnom skupu imamo stupce "WEIGHT", "HEIGHT", "GROUP" (stupac u kojem je 16 tipova osobnosti raspoređeno u 4 grupe) te stupac "IE" (u kojem je sadržan podatak o tome je li osoba introvert ili ekstrovert) koje ćemo koristiti u analiziranju visine i težine obzirom na tip ličnosti.


Prvo ćemo provjeriti normalnost numeričkih varijabli "HEIGHT" i "WEIGHT koje ćemo koristiti tokom analize.

```{r}
qqnorm(dataset$HEIGHT, main = "QQ Plot of HEIGHT variable")
qqline(dataset$HEIGHT, col = "red", lwd = 2)
```

```{r}
qqnorm(dataset$WEIGHT, main = "QQ Plot of WEIGHT variable")
qqline(dataset$WEIGHT, col = "red", lwd = 2)
```

Iz grafova možemo naslutiti kako se radi o naizgled normalno distribuiranim varijablama.
\
Pogledajmo sada konkretne p-vrijednosti Shapiro-Wilkovog testa normalnosti kako bi ustanovili pripadaju li ove varijable uistinu normalnoj distribuciji.

H0: Varijabla je normalno distribuirana
H1: Varijabla nije normalno distribuirana

```{r}
shapiro.test(dataset$HEIGHT)
```
Shapiro-Wilkov test normalnosti nam daje p-vrijednost 0.1028 uz razinu značajnosti 0.2, što znači da odbacujemo nultu hipotezu i zaključujemo kako varijabla HEIGHT nije normalno distribuirana

```{r}
shapiro.test(dataset$WEIGHT)
```
Za varijablu WEIGHT Shapiro-Wilkov test normalnosti nam daje p-vrijednost od 0.81, što znači da uz razinu značajnosti 0.2 ne možemo odbaciti nultu hipotezu i zaključujemo da je varijabla WEIGHT uistinu normalno distribuirana.

Iako varijabla HEIGHT nije normalna osim što njen histogram donekle nalikuje na normalnu distribuciju, pozivamo se na robusnost ANOVA testa i T-testa te ga ipak provodimo na podacima uz pretpostavku da su podaci nezavisni stoga ćemo nad rezultatima tih testova i donositi zaključke

### Usporedba srednjih visina za četiri grupe osobnosti

Za usporedbu srednjih visina za četiri grupe osobnosti primijenit ćemo analizu varijance (ANOVA) na naš podatkovni skup kako bismo usporedili srednje vrijednosti visine za četiri grupe osobnosti.
\
Postavljamo hipoteze, neka je mi-i prosječna vrijednost visina. Osobnosti su grupirane u četiri skupine: "Analysts", "Diplomats", "Explorers" i "Sentinels".

  H0: mi1 = mi2 = mi3 = mi4
  
  H1: barem dva mi-i nisu jednaka.
  
Za hipoteze postavljene na ovaj način, nije preporučljivo koristiti t-test više puta zbog povećanja rizika od greške tipa I. Stoga, odabrali smo ANOVA (Analiza varijance) kao odgovarajuću metodu. ANOVA se primjenjuje uz pretpostavke normalnosti distribucije reziduala, jednakih varijanci između grupa i nezavisnosti podataka unutar grupa.

Prije provedbe ANOVA-e moramo pokazati da su varijance grupa jednake.


Proučimo varijance visina za pojedine grupe osobnosti:
```{r}
vars_height <- aggregate(HEIGHT ~ GROUP, data = dataset, var)
vars_height
```


Provest ćemo Bartlettov test o jednakosti varijanci koji testira hipoteze:

  H0: varijance su jednake.
  H1: barem dvije varijance nisu jednake.
  
```{r}
bartlett.test(HEIGHT ~ GROUP, data=dataset)
```
Vidimo da je p-vrijednost velika te zato ne odbacujemo nultu hipotezu te zaključujemo da su varijance među grupama jednake.

Sada smo sigurni da možemo provesti ANOVA-u.

Na sljedećem grafu možemo vidjeti distribucije pojedinih grupa osobnosti s obzirom na njihove visine.
```{r}
ggplot(dataset, aes(x = HEIGHT, fill = GROUP)) + 
  geom_bar(alpha = 0.75) + 
  labs(x = "Height", y = "Count", fill = "") + 
  scale_fill_ordinal()
```

```{r}
ggplot(dataset, aes(x = GROUP,y = HEIGHT)) + 
  geom_boxplot() + 
  labs(x = "Personality groups", 
       y = "Height", 
       title = "Box-plots of height by personality group")
```
Iz ovog grafa možemo vidjeti distribucije pojedinih grupa osobnosti u obliku box-plota iz kojih dobijemo vizualnu reprezentaciju njihovih medijana i interkvartilnih rangova. Možemo vidjeti kako su medijani grupa "Analysts" i "Explorers" na rubu granica interkvartilnog ranga grupe "Sentinels", stoga ovdje možemo očekivati neke probleme oko jednakosti sredina i standardnih devijacija ovih grupa.

Pogledajmo srednje vrijednosti visina za pojedine grupe osobnosti:
```{r}
means_height <- aggregate(HEIGHT ~ GROUP, data = dataset, mean)
means_height
```

Sad provedimo test:

```{r}
model <- aov(HEIGHT ~ GROUP, data = dataset)
summary(model)
```
Obzirom na p-vrijednost od 0.47 ne odbacujemo nultu hipotezu. To sugerira da nema dovoljno dokaza za zaključak da postoje značajne razlike u prosječnoj visini između četiri skupine osobnosti.


### Usporedba srednjih težina za ekstroverte i introverte


Na sljedećem grafu možemo vidjeti distribuciju introverata/ekstroverata obzirom na njihove težine.
```{r}
ggplot(dataset, aes(x = WEIGHT, fill = IE)) + 
  geom_histogram(alpha = 0.75) + 
  labs(x = "Height", y = "Count", fill = "") + 
  scale_fill_ordinal()
```
Sada ćemo usporediti srednje vrijednosti težina ekstroverata i introverata koristeći stupce "IE" i "WEIGHT" koristeći t-test.

Prije provedbe t-testa moramo profesti F-test da provjerimo jednakost varijanci budući da su nepoznate.


Pogledajmo prije varijance težina introverata:
```{r}
vars_weight <- aggregate(WEIGHT ~ IE, data = dataset, var)
vars_weight
```


F-test ćemo provesti sa hipotezama:

  H0: varijance su jednake
  
  H1: varijance nisu jednake
  
```{r}
f_test <- var.test(HEIGHT ~ IE, data = dataset)
f_test
```
F-test daje p-vrijednost 0.6418 te zaključujemo da su varijance jednake.

Sada možemo provesti T-test uz jednake, ali nepoznate varijance.

Pogledajmo srednje vrijednosti težina ekstroverata i introverata.
```{r}
means_weight <- aggregate(WEIGHT ~ IE, data = dataset, mean)
means_weight
```


Test provodimo sa hipotezama:

  H0: srednje vrijednosti težine jednake su za ekstroverte i introverte
  
  H1: srednje vrijednosti težine nisu jednake za ekstroverte i introverte

```{r}
t_test <- t.test(HEIGHT ~ IE, data = dataset, var.equal = TRUE)
t_test
```
Zbog velike p-vrijednosti ne odbacujemo nultu hipotezu te zaključujemo da su srednje vrijednosti visina za introverte i ekstroverte jednake.


## Tip ličnosti na temelju pojedinih karakteristika

U ovom zadatku pokušavamo predvidjeti tip ličnosti na temelju pojedinih karakteristika.
Nismo mogli izračunati točnu vezu s MBTI tipom osobnosti jer je to diskretna varijabla, pa smo umjesto nje pokušavali predvidjeti koeficijente za pojedino svojstvo (npr. ekstrovertnost, intuitivnost, itd.) koristeći linearnu regresiju i uspoređivanjem dobivenih koeficijenata za isto svojstvo, u našem primjeru za J (prosuđivanje) i P (opažanje). Osoba spada u kategoriju J ili P ovisno o tome koji je koeficijent (predviđan linearnom regresijom) veći. Najprije je bilo potrebno testirati više modela linearne regresije, tj. odabrati koje regresore koristiti u modelu. Za pojedine modele smo izračunali R^2 vrijednost, koja nam govori koliko dobro model objašnjava varijabilnost podataka. Model s najvećom R^2 vrijednosti je najbolji model. Nakon što smo odabrali najbolji model, izračunali smo koeficijente za J i P, te smo na temelju njih odredili tu kategoriju.

```{r}
print("Prvi model za J i P karakteristike")
model <- lm(formula = dataset$J ~ dataset$HEIGHT + 
              dataset$SEX + 
              dataset$AGE
            )
model_summary <- summary(model)
r_squared <- model_summary$r.squared
print(paste("R kvadrat za predikciju slova J prvim modelom", r_squared))

model <- lm(formula = dataset$P ~ dataset$HEIGHT + 
              dataset$SEX + 
              dataset$AGE
            )
model_summary <- summary(model)
r_squared <- model_summary$r.squared
print(paste("R kvadrat za predikciju slova P prvim modelom", r_squared))

print("Drugi model za J i P karakteristike")
model <- lm(formula = dataset$J ~ dataset$HEIGHT + 
    dataset$WEIGHT + 
    dataset$SEX + 
    dataset$AGE + 
    dataset$ACTIVITY_LEVEL
  )
model_summary <- summary(model)
r_squared <- model_summary$r.squared
print(paste("R kvadrat za predikciju slova J drugim modelom", r_squared))

model <- lm(formula = dataset$P ~ dataset$HEIGHT + 
              dataset$WEIGHT + 
              dataset$SEX + 
              dataset$AGE + 
              dataset$ACTIVITY_LEVEL
            )
model_summary <- summary(model)
r_squared <- model_summary$r.squared
print(paste("R kvadrat za predikciju slova P drugim modelom", r_squared))

print("Treci model za J i P karakteristike")
model <- lm(formula = dataset$J ~ dataset$HEIGHT + 
              dataset$WEIGHT + 
              dataset$SEX + 
              dataset$AGE + 
              dataset$ACTIVITY_LEVEL + 
              dataset$PAIN_1 + 
              dataset$PAIN_2 + 
              dataset$PAIN_3 + 
              dataset$PAIN_4
            )
model_summary <- summary(model)
r_squared <- model_summary$r.squared
print(paste("R kvadrat za predikciju slova J trecim modelom", r_squared))

model <- lm(formula = dataset$P ~ dataset$HEIGHT + 
              dataset$WEIGHT + 
              dataset$SEX + 
              dataset$AGE + 
              dataset$ACTIVITY_LEVEL + 
              dataset$PAIN_1 + 
              dataset$PAIN_2 + 
              dataset$PAIN_3 + 
              dataset$PAIN_4
            )
model_summary <- summary(model)
r_squared <- model_summary$r.squared
print(paste("R kvadrat za predikciju slova P trecim modelom", r_squared))
```
Vidimo kako je najprikladniji ispao treći model jer ima najveću R kvadrat vrijednost. Testirajmo točnost modela
```{r}
model <- lm(formula = dataset$J ~ dataset$HEIGHT + 
              dataset$WEIGHT + 
              dataset$SEX + 
              dataset$AGE + 
              dataset$ACTIVITY_LEVEL + 
              dataset$PAIN_1 + 
              dataset$PAIN_2 + 
              dataset$PAIN_3 + 
              dataset$PAIN_4
            )
model_summary <- summary(model)
probs1 <- predict(model, newdata = dataset, type = "response")

model <- lm(formula = dataset$P ~ dataset$HEIGHT + 
              dataset$WEIGHT + 
              dataset$SEX + 
              dataset$AGE + 
              dataset$ACTIVITY_LEVEL + 
              dataset$PAIN_1 + 
              dataset$PAIN_2 + 
              dataset$PAIN_3 + 
              dataset$PAIN_4
            )
model_summary <- summary(model)
probs2 <- predict(model, newdata = dataset, type = "response")

slova <- ifelse(probs1>probs2, "J", "P")
vrijednosti <- ifelse(slova == substr(dataset$MBTI, 4, 4), 1, 0)
uk <- sum(vrijednosti)/length(vrijednosti)

print(paste("Točnost", uk))
```

Kod procjene spada li osoba u kategoriju J ili P, dobili smo točnost od 0.6289, što je zadovoljavajuće. Ovo je dobar rezultat s obzirom na to da je naš model bio jednostavan, tj. nije sadržavao puno regresora, a i podaci su bili dosta neujednačeni, tj. određenih osobnosti nije bilo željene količine. 

Možemo ponoviti testiranje za još jednu karaktristiku, npr. razmišljanje i osjećanje

```{r}
print("Prvi model za F i T karakteristike")
model <- lm(formula = dataset$F ~ dataset$HEIGHT + 
              dataset$SEX + 
              dataset$AGE
            )
model_summary <- summary(model)
r_squared <- model_summary$r.squared
print(paste("R kvadrat za predikciju slova F prvim modelom", r_squared))

model <- lm(formula = dataset$T ~ dataset$HEIGHT + 
              dataset$SEX + 
              dataset$AGE
            )
model_summary <- summary(model)
r_squared <- model_summary$r.squared
print(paste("R kvadrat za predikciju slova T prvim modelom", r_squared))

print("Drugi model za F i T karakteristike")
model <- lm(formula = dataset$F ~ dataset$HEIGHT +
              dataset$WEIGHT + 
              dataset$SEX + 
              log(dataset$AGE) + 
              dataset$ACTIVITY_LEVEL + 
              dataset$PAIN_1 + 
              dataset$PAIN_2 + 
              dataset$PAIN_3 +
              dataset$PAIN_4
            )
model_summary <- summary(model)
r_squared <- model_summary$r.squared
print(paste("R kvadrat za predikciju slova F drugim modelom", r_squared))

model <- lm(formula = dataset$T ~ dataset$HEIGHT + 
              dataset$WEIGHT + 
              dataset$SEX + 
              log(dataset$AGE) + 
              dataset$ACTIVITY_LEVEL + 
              dataset$PAIN_1 + 
              dataset$PAIN_2 + 
              dataset$PAIN_3 + 
              dataset$PAIN_4
            )
model_summary <- summary(model)
r_squared <- model_summary$r.squared
print(paste("R kvadrat za predikciju slova T drugim modelom", r_squared))

print("Treci model za F i T karakteristike")
model <- lm(formula = dataset$F ~ dataset$HEIGHT + 
              dataset$WEIGHT + 
              dataset$SEX + 
              dataset$AGE + 
              dataset$ACTIVITY_LEVEL + 
              dataset$PAIN_1 + 
              dataset$PAIN_2 + 
              dataset$PAIN_3 + 
              dataset$PAIN_4
            )
model_summary <- summary(model)
r_squared <- model_summary$r.squared
print(paste("R kvadrat za predikciju slova F trecim modelom", r_squared))

model <- lm(formula = dataset$T ~ dataset$HEIGHT + 
              dataset$WEIGHT + 
              dataset$SEX +
              dataset$AGE +
              dataset$ACTIVITY_LEVEL + 
              dataset$PAIN_1 +
              dataset$PAIN_2 + 
              dataset$PAIN_3 +
              dataset$PAIN_4
            )
model_summary <- summary(model)
r_squared <- model_summary$r.squared
print(paste("R kvadrat za predikciju slova T trecim modelom", r_squared))

```
Drugi model se pokazuje kao najbolji, testiramo

```{r}
model <- lm(formula = dataset$F ~ dataset$HEIGHT + 
              dataset$WEIGHT + 
              dataset$SEX + 
              log(dataset$AGE) + 
              dataset$ACTIVITY_LEVEL + 
              dataset$PAIN_1 + 
              dataset$PAIN_2 +
              dataset$PAIN_3 + 
              dataset$PAIN_4
            )
model_summary <- summary(model)
probs1 <- predict(model, newdata = dataset, type = "response")

model <- lm(formula = dataset$T ~ dataset$HEIGHT +
              dataset$WEIGHT +
              dataset$SEX +
              log(dataset$AGE) +
              dataset$ACTIVITY_LEVEL +
              dataset$PAIN_1 + 
              dataset$PAIN_2 +
              dataset$PAIN_3 +
              dataset$PAIN_4)

model_summary <- summary(model)
probs2 <- predict(model, newdata = dataset, type = "response")

slova <- ifelse(probs1>probs2, "F", "T")
vrijednosti <- ifelse(slova == substr(dataset$MBTI, 3, 3), 1, 0)
uk <- sum(vrijednosti)/length(vrijednosti)

print(paste("Točnost", uk))
```
Dobivena je točnost 0.7010


## Je li postotak ekstrovertnih ljudi isti kod ljudi iznad i ispod 45 godina

Kako bismo testirali je li postotak ekstroverata isti kod mladjih i starijih ljudi, koristit ćemo Z-test za dvije proporcije, uz alfa=0.05, a hipoteze postavljamo ovako
H0 : postotak ekstroverata je isti neovisno o godinama (p1 - p2 = 0)
H1 : postotak ekstroverata se razlikuje ovisno o godinama (p1 - p2 != 0)

```{r}
subset_result <- subset(dataset, AGE < 46 & substr(MBTI, 1, 1) == "E")
Eyoung <- nrow(subset_result)
total_group1 <- sum(dataset$AGE <= 45)

subset_result <- subset(dataset, AGE > 45 & substr(MBTI, 1, 1) == "E")
Eold <- nrow(subset_result)
total_group2 <- sum(dataset$AGE > 45)

# Perform the z-test for proportions
z_test_result <- prop.test(c(Eyoung, Eold),
                           c(total_group1, total_group2),
                           alternative = "two.sided")

# Print the result
print(z_test_result)
```
Iz polja p-value koji je veći od 0.05 zaključujemo kako na temelju ovih podataka nemamo razloga sumnjati u H0 te ju s toga ne odbacujemo.
***

# Zaključak

```{r}
qqnorm(dataset$AGE, main = "QQ Plot of AGE variable")
qqline(dataset$AGE, col = "red", lwd = 2)
```






\
```{r}
shapiro.test(dataset$AGE)
```
Uz p-value od 0.068 uz razinu značajnosti od 0.2 odbacujemo nultu hipotezu i zaključujemo da varijabla AGE nije normalno distribuirana.
(---prazan prostor za zaključak---)


